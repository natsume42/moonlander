#include "leds.h"

extern bool         g_suspend_state;
extern rgb_config_t rgb_matrix_config;

const uint8_t PROGMEM ledmap[][DRIVER_LED_TOTAL][3] = {
    [1] = {{0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {33, 255, 255}, {33, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 255, 255}, {86, 255, 255}, {0, 255, 255}, {0, 0, 0}, {0, 0, 0}, {86, 255, 255}, {86, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 255, 255}, {86, 255, 255}, {0, 255, 255}, {86, 255, 255}, {0, 0, 0}, {33, 255, 255}, {33, 255, 255}, {141, 255, 233}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {30, 96, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {30, 96, 255}, {141, 255, 233}, {141, 255, 233}, {0, 0, 0}, {0, 0, 0}, {30, 96, 255}, {141, 255, 233}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {30, 96, 255}, {141, 255, 233}, {0, 0, 0}, {86, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}},

    [2] = {{0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 255}, {0, 255, 255}, {85, 203, 158}, {0, 0, 0}, {0, 0, 0}, {0, 205, 155}, {35, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {35, 255, 255}, {35, 255, 255}, {180, 255, 233}, {0, 0, 0}, {0, 0, 0}, {0, 205, 155}, {35, 255, 255}, {233, 218, 217}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {14, 222, 242}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {35, 255, 255}, {35, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {35, 255, 255}, {35, 255, 255}, {35, 255, 255}, {0, 0, 0}, {0, 0, 0}, {154, 255, 255}, {154, 255, 255}, {154, 255, 255}, {0, 0, 0}, {0, 0, 0}, {154, 255, 255}, {154, 255, 255}, {154, 255, 255}, {0, 0, 0}, {249, 228, 255}, {154, 255, 255}, {154, 255, 255}, {154, 255, 255}, {86, 255, 255}, {0, 0, 0}, {35, 255, 255}, {35, 255, 255}, {154, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}},

    [3] = {{122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {29, 255, 255},  {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {29, 255, 255}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172},
           {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {86, 255, 255}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}, {122, 216, 172}},

    [4] = {{29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {86, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255},
           {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {86, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}, {29, 255, 255}},

    [5] = {{0, 0, 255}, {0, 0, 255}, {154, 255, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {154, 255, 255}, {0, 0, 255}, {0, 0, 255}, {154, 255, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {86, 255, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {154, 255, 255}, {0, 0, 255}, {0, 0, 255}, {154, 255, 255}},

    [6] = {{0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243},  {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243},
           {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {86, 255, 255}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}, {0, 249, 243}},

    [7] = {{0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {152, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {152, 255, 255}, {152, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {152, 255, 255}, {152, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {152, 255, 255}, {152, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {152, 255, 255}, {152, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {86, 255, 255}, {0, 0, 0}, {0, 0, 255}, {0, 0, 255}, {0, 0, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}},

    [8] = {{0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 255}, {0, 0, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {249, 228, 255}, {249, 228, 255}, {0, 0, 255}, {0, 0, 0}, {0, 0, 0}, {249, 228, 255}, {249, 228, 255}, {33, 255, 255}, {0, 0, 0}, {0, 0, 0}, {154, 255, 255}, {0, 0, 255}, {33, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {154, 255, 255}, {0, 0, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 255}, {35, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {199, 255, 255}, {86, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {141, 255, 233}, {35, 255, 255}, {0, 0, 0}, {86, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {243, 222, 234}, {85, 203, 158}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}},

    [9] = {{196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173},
           {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {86, 255, 255},  {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}, {196, 235, 173}},

};

void set_layer_color(int layer);

void set_layer_color(int layer) {
    for (int i = 0; i < DRIVER_LED_TOTAL; i++) {
        HSV hsv = {
            .h = pgm_read_byte(&ledmap[layer][i][0]),
            .s = pgm_read_byte(&ledmap[layer][i][1]),
            .v = pgm_read_byte(&ledmap[layer][i][2]),
        };
        if (!hsv.h && !hsv.s && !hsv.v) {
            rgb_matrix_set_color(i, 0, 0, 0);
        } else {
            RGB   rgb = hsv_to_rgb(hsv);
            float f   = (float)rgb_matrix_config.hsv.v / UINT8_MAX;
            rgb_matrix_set_color(i, f * rgb.r, f * rgb.g, f * rgb.b);
        }
    }
}

void rgb_matrix_indicators_user(void) {
    if (g_suspend_state || keyboard_config.disable_layer_led) {
        return;
    }
    switch (biton32(layer_state)) {
        case 1:
            set_layer_color(1);
            break;
        case 2:
            set_layer_color(2);
            break;
        case 3:
            set_layer_color(3);
            break;
        case 4:
            set_layer_color(4);
            break;
        case 5:
            set_layer_color(5);
            break;
        case 6:
            set_layer_color(6);
            break;
        case 7:
            set_layer_color(7);
            break;
        case 8:
            set_layer_color(8);
            break;
        case 9:
            set_layer_color(9);
            break;
        default:
            if (rgb_matrix_get_flags() == LED_FLAG_NONE) rgb_matrix_set_color_all(0, 0, 0);
            break;
    }
}
